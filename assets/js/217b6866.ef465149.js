"use strict";(globalThis.webpackChunkbeacon_docs=globalThis.webpackChunkbeacon_docs||[]).push([[1118,5509,8737],{11470:(e,n,t)=>{t.d(n,{A:()=>A});var r=t(96540),s=t(34164),a=t(17559),o=t(23104),c=t(56347),i=t(205),l=t(57485),u=t(31682),d=t(70679);function p(e){return r.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function m(e){const{values:n,children:t}=e;return(0,r.useMemo)(()=>{const e=n??function(e){return p(e).map(({props:{value:e,label:n,attributes:t,default:r}})=>({value:e,label:n,attributes:t,default:r}))}(t);return function(e){const n=(0,u.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,t])}function f({value:e,tabValues:n}){return n.some(n=>n.value===e)}function h({queryString:e=!1,groupId:n}){const t=(0,c.W6)(),s=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,l.aZ)(s),(0,r.useCallback)(e=>{if(!s)return;const n=new URLSearchParams(t.location.search);n.set(s,e),t.replace({...t.location,search:n.toString()})},[s,t])]}function g(e){const{defaultValue:n,queryString:t=!1,groupId:s}=e,a=m(e),[o,c]=(0,r.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!f({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find(e=>e.default)??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:a})),[l,u]=h({queryString:t,groupId:s}),[p,g]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,s]=(0,d.Dv)(n);return[t,(0,r.useCallback)(e=>{n&&s.set(e)},[n,s])]}({groupId:s}),b=(()=>{const e=l??p;return f({value:e,tabValues:a})?e:null})();(0,i.A)(()=>{b&&c(b)},[b]);return{selectedValue:o,selectValue:(0,r.useCallback)(e=>{if(!f({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);c(e),u(e),g(e)},[u,g,a]),tabValues:a}}var b=t(92303);const v={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=t(74848);function w({className:e,block:n,selectedValue:t,selectValue:r,tabValues:a}){const c=[],{blockElementScrollPositionUntilNextRender:i}=(0,o.a_)(),l=e=>{const n=e.currentTarget,s=c.indexOf(n),o=a[s].value;o!==t&&(i(n),r(o))},u=e=>{let n=null;switch(e.key){case"Enter":l(e);break;case"ArrowRight":{const t=c.indexOf(e.currentTarget)+1;n=c[t]??c[0];break}case"ArrowLeft":{const t=c.indexOf(e.currentTarget)-1;n=c[t]??c[c.length-1];break}}n?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":n},e),children:a.map(({value:e,label:n,attributes:r})=>(0,x.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{c.push(e)},onKeyDown:u,onClick:l,...r,className:(0,s.A)("tabs__item",v.tabItem,r?.className,{"tabs__item--active":t===e}),children:n??e},e))})}function k({lazy:e,children:n,selectedValue:t}){const a=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=a.find(e=>e.props.value===t);return e?(0,r.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:a.map((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==t}))})}function y(e){const n=g(e);return(0,x.jsxs)("div",{className:(0,s.A)(a.G.tabs.container,"tabs-container",v.tabList),children:[(0,x.jsx)(w,{...n,...e}),(0,x.jsx)(k,{...n,...e})]})}function A(e){const n=(0,b.A)();return(0,x.jsx)(y,{...e,children:p(e.children)},String(n))}},14252:(e,n,t)=>{t.d(n,{A:()=>o});t(96540);var r=t(65195);const s={tableOfContentsInline:"tableOfContentsInline_prmo"};var a=t(74848);function o({toc:e,minHeadingLevel:n,maxHeadingLevel:t}){return(0,a.jsx)("div",{className:s.tableOfContentsInline,children:(0,a.jsx)(r.A,{toc:e,minHeadingLevel:n,maxHeadingLevel:t,className:"table-of-contents",linkClassName:null})})}},19365:(e,n,t)=>{t.d(n,{A:()=>o});t(96540);var r=t(34164);const s={tabItem:"tabItem_Ymn6"};var a=t(74848);function o({children:e,hidden:n,className:t}){return(0,a.jsx)("div",{role:"tabpanel",className:(0,r.A)(s.tabItem,t),hidden:n,children:e})}},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>c});var r=t(96540);const s={},a=r.createContext(s);function o(e){const n=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(a.Provider,{value:n},e.children)}},36083:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>u,default:()=>f,frontMatter:()=>l,metadata:()=>r,toc:()=>p});const r=JSON.parse('{"id":"wallet/getting-started/ios/disconnect-from-dapp","title":"Disconnect from a dApp","description":"This guide is a continuation of Connect to a dApp and may assume that certain code components have been defined.","source":"@site/docs/wallet/getting-started/ios/disconnect-from-dapp.mdx","sourceDirName":"wallet/getting-started/ios","slug":"/wallet/getting-started/ios/disconnect-from-dapp","permalink":"/wallet/getting-started/ios/disconnect-from-dapp","draft":false,"unlisted":false,"editUrl":"https://github.com/airgap-it/beacon-docs/edit/main/src/docs/wallet/getting-started/ios/disconnect-from-dapp.mdx","tags":[],"version":"current","frontMatter":{"title":"Disconnect from a dApp"},"sidebar":"wallet","previous":{"title":"Connect to a dApp","permalink":"/wallet/getting-started/ios/connect-to-dapp"},"next":{"title":"Configuration","permalink":"/wallet/advanced/android/configuration"}}');var s=t(74848),a=t(28453),o=t(11470),c=t(19365),i=t(14252);const l={title:"Disconnect from a dApp"},u=void 0,d={},p=[{value:"Disconnect from a dApp",id:"disconnect-from-a-dapp",level:2},{value:"Disconnect from all dApps",id:"disconnect-from-all-dapps",level:2},{value:"Example Code",id:"example-code",level:2}];function m(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.A,{toc:p}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["This guide is a continuation of ",(0,s.jsx)(n.a,{href:"connect-to-dapp",children:"Connect to a dApp"})," and may assume that certain code components have been defined."]})}),"\n",(0,s.jsx)(n.h2,{id:"disconnect-from-a-dapp",children:"Disconnect from a dApp"}),"\n",(0,s.jsx)(n.p,{children:"To disconnect form a subscribed dApp remove its peer entry from the client."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'beaconWallet.getPeers { result in\n    guard case let .success(peers) = result else {\n        return\n    }\n\n    guard let dApp = peers.first(where: { $0.name == "MyApp" }) else {\n        return\n    }\n\n    beaconWallet.remove([dApp]) { result in\n        guard case .success(_) = result else {\n            return\n        }\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"disconnect-from-all-dapps",children:"Disconnect from all dApps"}),"\n",(0,s.jsx)(n.p,{children:"To disconnect from all subscribed dApps remove all peers that were previously registered in the client."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:"beaconWallet.removeAllPeers { result in\n    guard case .success(_) = result else {\n        return\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"example-code",children:"Example Code"}),"\n",(0,s.jsxs)(n.p,{children:["The following example extends the code presented in the ",(0,s.jsx)(n.a,{href:"connect-to-dapp#ExampleCode",children:"Connect to a dApp"})," guide. The example class listens for incoming requests from a dApp, waits 1s and cancels connection."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://github.com/airgap-it/beacon-ios-sdk",children:(0,s.jsx)(n.img,{src:"https://img.shields.io/github/v/tag/airgap-it/beacon-ios-sdk?label=stable&sort=semver",alt:"stable"})}),"\n",(0,s.jsx)(n.a,{href:"https://github.com/airgap-it/beacon-ios-sdk",children:(0,s.jsx)(n.img,{src:"https://img.shields.io/github/v/tag/airgap-it/beacon-ios-sdk?color=orange&include_prereleases&label=latest",alt:"latest"})})]}),"\n",(0,s.jsxs)(o.A,{groupId:"package-manager",defaultValue:"spm",values:[{label:"SPM",value:"spm"},{label:"CocoaPods",value:"cocoapods"}],children:[(0,s.jsxs)(c.A,{value:"spm",children:[(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",metastring:'title="Package.swift"',children:'dependencies: [\n    .package(url: "https://github.com/airgap-it/beacon-ios-sdk", from: "x.y.z")\n],\n'})}),(0,s.jsxs)(n.p,{children:["Or in Xcode open the ",(0,s.jsx)(n.code,{children:"Add Package Dependency"})," window (as described in ",(0,s.jsx)(n.a,{href:"https://developer.apple.com/documentation/xcode/adding_package_dependencies_to_your_app",children:"the official guide"}),") and enter the ",(0,s.jsx)(n.code,{children:"Beacon iOS SDK"})," GitHub repository URL"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"https://github.com/airgap-it/beacon-ios-sdk\n"})})]}),(0,s.jsx)(c.A,{value:"cocoapods",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ruby",metastring:'title="Podfile"',children:"target 'MyTarget' do\n    use_frameworks!\n\n    pod 'BeaconCore', :git => 'https://github.com/airgap-it/beacon-ios-sdk', :tag => 'x.y.z'\n    pod 'BeaconClientWallet', :git => 'https://github.com/airgap-it/beacon-ios-sdk', :tag => 'x.y.z'\n    pod 'BeaconBlockchainSubstrate', :git => 'https://github.com/airgap-it/beacon-ios-sdk', :tag => 'x.y.z'\n    pod 'BeaconBlockchainTezos', :git => 'https://github.com/airgap-it/beacon-ios-sdk', :tag => 'x.y.z'\n    pod 'BeaconTransportP2PMatrix', :git => 'https://github.com/airgap-it/beacon-ios-sdk', :tag => 'x.y.z'\nend\n"})})})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",metastring:'title="BeaconExample.swift"',children:'import Foundation\nimport BeaconCore\nimport BeaconBlockchainSubstrate\nimport BeaconBlockchainTezos\nimport BeaconClientWallet\nimport BeaconTransportP2PMatrix\n\nclass BeaconExample {\n    var beaconWallet: Beacon.WalletClient!\n\n    let dApp = Beacon.P2PPeer(\n        id: "0b02d44c-de33-b5ab-7730-ff8e62f61869" /* TODO: change me */,,\n        name: "My dApp",\n        publicKey: "6c7870aa1e42477fd7c2baaf4763bd826971e470772f71a0a388c1763de3ea1e" /* TODO: change me */,\n        relayServer: "beacon-node-1.sky.papers.tech" /* TODO: change me */,\n        version: "2" /* TODO: change me */\n    )\n\n    func substrateAccount(network: Substrate.Network) throws -> Substrate.Account {\n        try Substrate.Account(\n            publicKey: "f4c6095213a2f6d09464ed882b12d6024d20f7170c3b8bd5c1b071e4b00ced72" /* TODO: change me */,\n            address: "16XwWkdUqFXFY1tJNf1Q6fGgxQnGYUS6M95wPcrbp2sjjuoC" /* TODO: change me */,\n            network: network\n        )\n    }\n\n    func tezosAccount(network: Tezos.Network) throws -> Tezos.Account {\n        try Tezos.Network(\n            publicKey: "9ae0875d510904b0b15d251d8def1f5f3353e9799841c0ed6d7ac718f04459a0" /* TODO: change me */,\n            address: "tz1SkbBZg15BXPRkYCrSzhY6rq4tKGtpUSWv" /* TODO: change me */,\n            network: network\n        )\n    }\n\n    func run() {\n        createBeaconWallet { result in\n            guard case .success(_) = result else {\n                return\n            }\n\n            self.subscribeToRequests { result in\n                guard case .success(_) = result else {\n                    return\n                }\n\n                self.connectToDApp { result in\n                    guard case .success(_) = result else {\n                        return\n                    }\n                }\n            }\n        }\n    }\n\n    func createBeaconWallet(completion: @escaping (Result<(), Error>) -> ()) {\n        do {\n            Beacon.WalletClient.create(\n                with: .init(\n                    name: "MyApp",\n                    blockchains: [Substrate.factory, Tezos.factory],\n                    connections: [try Transport.P2P.Matrix.connection()]\n                )\n            ) { result in\n                switch result {\n                case let .success(client):\n                    self.beaconWallet = client\n                    completion(.success(()))\n                case let .failure(error):\n                    completion(.failure(error))\n                }\n            }\n        } catch {\n            completion(.failure(error))\n        }\n    }\n\n    func subscribeToRequests(completion: @escaping (Result<(), Error>) -> ()) {\n        beaconWallet.connect { result in\n            switch result {\n            case .success(_):\n                self.beaconWallet.listen(onRequest: self.onSubstrateRequest)\n                self.beaconWallet.listen(onRequest: self.onTezosRequest)\n                completion(.success(()))\n            case let .failure(error):\n                completion(.failure(error))\n            }\n        }\n    }\n\n    func connectToDApp(completion: @escaping (Result<(), Error>) -> ()) {\n        beaconWallet.add([.p2p(dApp)]) { result in\n            switch result {\n            case .success(_):\n                completion(.success(()))\n            case let .failure(error):\n                completion(.failure(error))\n            }\n        }\n    }\n\n    func onSubstrateRequest(_ request: Result<BeaconRequest<Substrate>, Beacon.Error>) {\n        do {\n            let request = try request.get()\n            let response = try response(from: request)\n\n            beaconWallet.respond(with: response) { result in\n                switch result {\n                case .success(_):\n                    print("Response sent")\n                    DispatchQueue.main.asyncAfter(deadline: .now() + 1.0) {\n                        // highlight-start\n                        self.beaconWallet.remove([.p2p(self.dApp)]) { result in\n                        // highlight-end\n                            switch result {\n                            case .success(_):\n                                print("Disconnected")\n                            case let .failure(error):\n                                print(error)\n                            }\n                        }\n                    }\n                case let .failure(error):\n                    print(error)\n                }\n            }\n        } catch {\n            print(error)\n        }\n    }\n\n    func response(from request: BeaconRequest<Substrate>) throws -> BeaconResponse<Substrate> {\n        switch request {\n        case let .permission(content):\n            let accounts = try content.networks.map { try substrateAccount(network: $0) }\n            return .permission(PermissionSubstrateResponse(from: content, accounts: accounts))\n        case let .blockchain(blockchain):\n            return .error(ErrorBeaconResponse(from: blockchain, errorType: .aborted))\n        }\n    }\n\n    func onTezosRequest(_ request: Result<BeaconRequest<Tezos>, Beacon.Error>) {\n        do {\n            let request = try request.get()\n            let response = try response(from: request)\n\n            beaconWallet.respond(with: response) { result in\n                switch result {\n                case .success(_):\n                    print("Response sent")\n                    DispatchQueue.main.asyncAfter(deadline: .now() + 1.0) {\n                        // highlight-start\n                        self.beaconWallet.remove([.p2p(self.dApp)]) { result in\n                        // highlight-end\n                            switch result {\n                            case .success(_):\n                                print("Disconnected")\n                            case let .failure(error):\n                                print(error)\n                            }\n                        }\n                    }\n                case let .failure(error):\n                    print(error)\n                }\n            }\n        } catch {\n            print(error)\n        }\n    }\n\n    func response(from request: BeaconRequest<Tezos>) throws -> BeaconResponse<Tezos> {\n        switch request {\n        case let .permission(content):\n            let account = try tezosAccount(network: content.network)\n            return .permission(PermissionTezosResponse(from: content, account: account))\n        case let .blockchain(blockchain):\n            return .error(ErrorBeaconResponse(from: blockchain, errorType: .aborted))\n        }\n    }\n}\n'})})]})}function f(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(m,{...e})}):m(e)}},65195:(e,n,t)=>{t.d(n,{A:()=>h});var r=t(96540),s=t(6342);function a(e){const n=e.map(e=>({...e,parentIndex:-1,children:[]})),t=Array(7).fill(-1);n.forEach((e,n)=>{const r=t.slice(2,e.level);e.parentIndex=Math.max(...r),t[e.level]=n});const r=[];return n.forEach(e=>{const{parentIndex:t,...s}=e;t>=0?n[t].children.push(s):r.push(s)}),r}function o({toc:e,minHeadingLevel:n,maxHeadingLevel:t}){return e.flatMap(e=>{const r=o({toc:e.children,minHeadingLevel:n,maxHeadingLevel:t});return function(e){return e.level>=n&&e.level<=t}(e)?[{...e,children:r}]:r})}function c(e){const n=e.getBoundingClientRect();return n.top===n.bottom?c(e.parentNode):n}function i(e,{anchorTopOffset:n}){const t=e.find(e=>c(e).top>=n);if(t){return function(e){return e.top>0&&e.bottom<window.innerHeight/2}(c(t))?t:e[e.indexOf(t)-1]??null}return e[e.length-1]??null}function l(){const e=(0,r.useRef)(0),{navbar:{hideOnScroll:n}}=(0,s.p)();return(0,r.useEffect)(()=>{e.current=n?0:document.querySelector(".navbar").clientHeight},[n]),e}function u(e){const n=(0,r.useRef)(void 0),t=l();(0,r.useEffect)(()=>{if(!e)return()=>{};const{linkClassName:r,linkActiveClassName:s,minHeadingLevel:a,maxHeadingLevel:o}=e;function c(){const e=function(e){return Array.from(document.getElementsByClassName(e))}(r),c=function({minHeadingLevel:e,maxHeadingLevel:n}){const t=[];for(let r=e;r<=n;r+=1)t.push(`h${r}.anchor`);return Array.from(document.querySelectorAll(t.join()))}({minHeadingLevel:a,maxHeadingLevel:o}),l=i(c,{anchorTopOffset:t.current}),u=e.find(e=>l&&l.id===function(e){return decodeURIComponent(e.href.substring(e.href.indexOf("#")+1))}(e));e.forEach(e=>{!function(e,t){t?(n.current&&n.current!==e&&n.current.classList.remove(s),e.classList.add(s),n.current=e):e.classList.remove(s)}(e,e===u)})}return document.addEventListener("scroll",c),document.addEventListener("resize",c),c(),()=>{document.removeEventListener("scroll",c),document.removeEventListener("resize",c)}},[e,t])}var d=t(28774),p=t(74848);function m({toc:e,className:n,linkClassName:t,isChild:r}){return e.length?(0,p.jsx)("ul",{className:r?void 0:n,children:e.map(e=>(0,p.jsxs)("li",{children:[(0,p.jsx)(d.A,{to:`#${e.id}`,className:t??void 0,dangerouslySetInnerHTML:{__html:e.value}}),(0,p.jsx)(m,{isChild:!0,toc:e.children,className:n,linkClassName:t})]},e.id))}):null}const f=r.memo(m);function h({toc:e,className:n="table-of-contents table-of-contents__left-border",linkClassName:t="table-of-contents__link",linkActiveClassName:c,minHeadingLevel:i,maxHeadingLevel:l,...d}){const m=(0,s.p)(),h=i??m.tableOfContents.minHeadingLevel,g=l??m.tableOfContents.maxHeadingLevel,b=function({toc:e,minHeadingLevel:n,maxHeadingLevel:t}){return(0,r.useMemo)(()=>o({toc:a(e),minHeadingLevel:n,maxHeadingLevel:t}),[e,n,t])}({toc:e,minHeadingLevel:h,maxHeadingLevel:g});return u((0,r.useMemo)(()=>{if(t&&c)return{linkClassName:t,linkActiveClassName:c,minHeadingLevel:h,maxHeadingLevel:g}},[t,c,h,g])),(0,p.jsx)(f,{toc:b,className:n,linkClassName:t,...d})}}}]);