"use strict";(globalThis.webpackChunkbeacon_docs=globalThis.webpackChunkbeacon_docs||[]).push([[5845],{11470:(e,n,a)=>{a.d(n,{A:()=>y});var t=a(96540),s=a(34164),r=a(17559),o=a(23104),c=a(56347),l=a(205),i=a(57485),d=a(31682),u=a(70679);function h(e){return t.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,t.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function p(e){const{values:n,children:a}=e;return(0,t.useMemo)(()=>{const e=n??function(e){return h(e).map(({props:{value:e,label:n,attributes:a,default:t}})=>({value:e,label:n,attributes:a,default:t}))}(a);return function(e){const n=(0,d.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,a])}function b({value:e,tabValues:n}){return n.some(n=>n.value===e)}function g({queryString:e=!1,groupId:n}){const a=(0,c.W6)(),s=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,i.aZ)(s),(0,t.useCallback)(e=>{if(!s)return;const n=new URLSearchParams(a.location.search);n.set(s,e),a.replace({...a.location,search:n.toString()})},[s,a])]}function m(e){const{defaultValue:n,queryString:a=!1,groupId:s}=e,r=p(e),[o,c]=(0,t.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!b({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const a=n.find(e=>e.default)??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:n,tabValues:r})),[i,d]=g({queryString:a,groupId:s}),[h,m]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[a,s]=(0,u.Dv)(n);return[a,(0,t.useCallback)(e=>{n&&s.set(e)},[n,s])]}({groupId:s}),f=(()=>{const e=i??h;return b({value:e,tabValues:r})?e:null})();(0,l.A)(()=>{f&&c(f)},[f]);return{selectedValue:o,selectValue:(0,t.useCallback)(e=>{if(!b({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);c(e),d(e),m(e)},[d,m,r]),tabValues:r}}var f=a(92303);const v={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=a(74848);function A({className:e,block:n,selectedValue:a,selectValue:t,tabValues:r}){const c=[],{blockElementScrollPositionUntilNextRender:l}=(0,o.a_)(),i=e=>{const n=e.currentTarget,s=c.indexOf(n),o=r[s].value;o!==a&&(l(n),t(o))},d=e=>{let n=null;switch(e.key){case"Enter":i(e);break;case"ArrowRight":{const a=c.indexOf(e.currentTarget)+1;n=c[a]??c[0];break}case"ArrowLeft":{const a=c.indexOf(e.currentTarget)-1;n=c[a]??c[c.length-1];break}}n?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":n},e),children:r.map(({value:e,label:n,attributes:t})=>(0,x.jsx)("li",{role:"tab",tabIndex:a===e?0:-1,"aria-selected":a===e,ref:e=>{c.push(e)},onKeyDown:d,onClick:i,...t,className:(0,s.A)("tabs__item",v.tabItem,t?.className,{"tabs__item--active":a===e}),children:n??e},e))})}function T({lazy:e,children:n,selectedValue:a}){const r=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=r.find(e=>e.props.value===a);return e?(0,t.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:r.map((e,n)=>(0,t.cloneElement)(e,{key:n,hidden:e.props.value!==a}))})}function w(e){const n=m(e);return(0,x.jsxs)("div",{className:(0,s.A)(r.G.tabs.container,"tabs-container",v.tabList),children:[(0,x.jsx)(A,{...n,...e}),(0,x.jsx)(T,{...n,...e})]})}function y(e){const n=(0,f.A)();return(0,x.jsx)(w,{...e,children:h(e.children)},String(n))}},19365:(e,n,a)=>{a.d(n,{A:()=>o});a(96540);var t=a(34164);const s={tabItem:"tabItem_Ymn6"};var r=a(74848);function o({children:e,hidden:n,className:a}){return(0,r.jsx)("div",{role:"tabpanel",className:(0,t.A)(s.tabItem,a),hidden:n,children:e})}},28453:(e,n,a)=>{a.d(n,{R:()=>o,x:()=>c});var t=a(96540);const s={},r=t.createContext(s);function o(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(r.Provider,{value:n},e.children)}},46807:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>p,frontMatter:()=>l,metadata:()=>t,toc:()=>u});const t=JSON.parse('{"id":"getting-started/subscribe-to-active-account","title":"Subscribe to ACTIVE_ACCOUNT_SET Advanced Example","description":"Beacon provides developers the ability to subscribe to its internal state, as shown on the dedicated page. Since version 4.2.0, subscribing to ACTIVEACCOUNTSET has become mandatory. This page provides a custom example with user validation by requesting the wallet to sign a payload.","source":"@site/docs/getting-started/subscribe-to-active-account.mdx","sourceDirName":"getting-started","slug":"/getting-started/subscribe-to-active-account","permalink":"/getting-started/subscribe-to-active-account","draft":false,"unlisted":false,"editUrl":"https://github.com/airgap-it/beacon-docs/edit/main/src/docs/getting-started/subscribe-to-active-account.mdx","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Advanced Example","permalink":"/getting-started/advanced-example"},"next":{"title":"High Performance","permalink":"/getting-started/high-performance"}}');var s=a(74848),r=a(28453),o=a(11470),c=a(19365);const l={},i="Subscribe to ACTIVE_ACCOUNT_SET Advanced Example",d={},u=[{value:"Before Starting",id:"before-starting",level:2},{value:"Example",id:"example",level:2},{value:"Adding <code>requestSignPayload</code>",id:"adding-requestsignpayload",level:2},{value:"Multi-tab Synchronization",id:"multi-tab-synchronization",level:2},{value:"Step 1: Install <code>broadcast-channel</code>",id:"step-1-install-broadcast-channel",level:3},{value:"Step 2: Set Up the Channel",id:"step-2-set-up-the-channel",level:3},{value:"Step 3: Update the Handler",id:"step-3-update-the-handler",level:3},{value:"Conclusion",id:"conclusion",level:2},{value:"References",id:"references",level:2}];function h(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsxs)(n.h1,{id:"subscribe-to-active_account_set-advanced-example",children:["Subscribe to ",(0,s.jsx)(n.code,{children:"ACTIVE_ACCOUNT_SET"})," Advanced Example"]})}),"\n",(0,s.jsxs)(n.p,{children:["Beacon provides developers the ability to subscribe to its internal state, as shown on the dedicated page. Since version 4.2.0, subscribing to ",(0,s.jsx)(n.code,{children:"ACTIVE_ACCOUNT_SET"})," has become mandatory. This page provides a custom example with user validation by requesting the wallet to sign a payload."]}),"\n",(0,s.jsx)(n.h2,{id:"before-starting",children:"Before Starting"}),"\n",(0,s.jsxs)(n.p,{children:["Be aware that calling one of the functions listed below will also trigger ",(0,s.jsx)(n.code,{children:"ACTIVE_ACCOUNT_SET"}),". ",(0,s.jsx)("mark",{children:"Be careful when calling such functions inside the handler to avoid causing your dApp to enter an endless loop."})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"List of functions:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"requestPermissions"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"setActiveAccount"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"clearActiveAccount"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"disconnect"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"removeAccount"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"removeAllAccounts"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"destroy"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,s.jsxs)(n.p,{children:["After initializing your ",(0,s.jsx)(n.code,{children:"dAppClient"})," instance, you need to subscribe to ",(0,s.jsx)(n.code,{children:"ACTIVE_ACCOUNT_SET"})," as shown below:"]}),"\n",(0,s.jsxs)(o.A,{groupId:"beaconOrTaquitoSAAE1",defaultValue:"beacon",values:[{label:"Beacon",value:"beacon"},{label:"Taquito",value:"taquito"}],children:[(0,s.jsx)(c.A,{value:"beacon",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'const dAppClient = new DAppClient({\n  name: "Beacon Docs",\n});\n\ndAppClient.subscribeToEvent(BeaconEvent.ACTIVE_ACCOUNT_SET, (account) => {\n  console.log(`${BeaconEvent.ACTIVE_ACCOUNT_SET} triggered: `, account);\n});\n'})})}),(0,s.jsx)(c.A,{value:"taquito",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'const Tezos = new TezosToolkit("https://mainnet.api.tez.ie");\nconst wallet = new BeaconWallet({ name: "Beacon Docs" });\n\nwallet.client.subscribeToEvent(BeaconEvent.ACTIVE_ACCOUNT_SET, (account) => {\n  console.log(`${BeaconEvent.ACTIVE_ACCOUNT_SET} triggered: `, account);\n});\n'})})})]}),"\n",(0,s.jsx)(n.p,{children:"The handler should be as concise as possible. Ideally, it should just globally update your active account on your dApp. However, in some cases, adding extra lines of code may be necessary."}),"\n",(0,s.jsxs)(n.h2,{id:"adding-requestsignpayload",children:["Adding ",(0,s.jsx)(n.code,{children:"requestSignPayload"})]}),"\n",(0,s.jsxs)(n.p,{children:["Sometimes ",(0,s.jsx)(n.code,{children:"requestPermissions"})," may not be enough, and you want to ensure the user who has synced with the wallet is authorized. A common way to accomplish this is by sending a ",(0,s.jsx)(n.em,{children:"sign_payload"})," request to the wallet."]}),"\n",(0,s.jsxs)(o.A,{groupId:"beaconOrTaquitoSAAE2",defaultValue:"beacon",values:[{label:"Beacon",value:"beacon"},{label:"Taquito",value:"taquito"}],children:[(0,s.jsx)(c.A,{value:"beacon",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'dAppClient.subscribeToEvent(BeaconEvent.ACTIVE_ACCOUNT_SET, async (account) => {\n  console.log(\n    `${BeaconEvent.ACTIVE_ACCOUNT_SET} triggered: `,\n    account?.address,\n  );\n\n  if (!account) {\n    return;\n  }\n\n  try {\n    await dAppClient.requestSignPayload({\n      payload:\n        "05010000004254657a6f73205369676e6564204d6573736167653a207465737455726c20323032332d30322d30385431303a33363a31382e3435345a2048656c6c6f20576f726c64",\n    });\n  } catch (err: any) {\n    // The request was rejected\n    // handle disconnection\n  }\n});\n'})})}),(0,s.jsx)(c.A,{value:"taquito",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'wallet.client.subscribeToEvent(\n  BeaconEvent.ACTIVE_ACCOUNT_SET,\n  async (account) => {\n    console.log(\n      `${BeaconEvent.ACTIVE_ACCOUNT_SET} triggered: `,\n      account?.address,\n    );\n\n    if (!account) {\n      return;\n    }\n\n    try {\n      await wallet.client.requestSignPayload({\n        payload:\n          "05010000004254657a6f73205369676e6564204d6573736167653a207465737455726c20323032332d30322d30385431303a33363a31382e3435345a2048656c6c6f20576f726c64",\n      });\n    } catch (err: any) {\n      // The request was rejected\n      // handle disconnection\n    }\n  },\n);\n'})})})]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note:"})," ",(0,s.jsx)(n.code,{children:"ACTIVE_ACCOUNT_SET"})," gets triggered both when setting a new account and resetting the current one. Make sure not to send a ",(0,s.jsx)(n.strong,{children:"sign_payload"})," request without an account."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"multi-tab-synchronization",children:"Multi-tab Synchronization"}),"\n",(0,s.jsxs)(n.p,{children:["While the example above works for single-page dApps, it may become problematic in a multi-tab setup. Beacon emits an event to keep each tab synced with the internal state. Therefore, if your dApp needs multiple tabs support, the above approach may cause issues. Each tab will send a ",(0,s.jsx)(n.strong,{children:"sign_payload"})," request to the wallet, which is not intended and may lead to request rejection if a certain threshold is reached."]}),"\n",(0,s.jsxs)(n.p,{children:["To address this, we need to implement multi-tab synchronization. There are multiple ways to achieve this; for simplicity, we use ",(0,s.jsx)(n.code,{children:"broadcast-channel"}),"."]}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"The following example is designed to be as simple as possible to help developers kickstart synchronization in their dApp. Please note that not all edge cases are covered."})}),"\n",(0,s.jsxs)(n.h3,{id:"step-1-install-broadcast-channel",children:["Step 1: Install ",(0,s.jsx)(n.code,{children:"broadcast-channel"})]}),"\n",(0,s.jsx)(n.p,{children:"Run the following command:"}),"\n",(0,s.jsxs)(o.A,{groupId:"beaconOrTaquitoSAAE3",defaultValue:"npm",values:[{label:"NPM",value:"npm"},{label:"Yarn",value:"yarn"}],children:[(0,s.jsx)(c.A,{value:"npm",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install --save broadcast-channel\n"})})}),(0,s.jsx)(c.A,{value:"yarn",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"yarn add broadcast-channel\n"})})})]}),"\n",(0,s.jsx)(n.h3,{id:"step-2-set-up-the-channel",children:"Step 2: Set Up the Channel"}),"\n",(0,s.jsx)(n.p,{children:"The main idea is to elect a tab as the Leader so that only this tab will send a request to the wallet. First, set up a channel."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'const channel = new BroadcastChannel("beacon-channel"); // "beacon-channel" is an example, you can choose any name you want\nconst elector = createLeaderElection(channel);\n// Auxiliary variable needed for handling beforeUnload.\n// Closing a tab causes the elector to be killed immediately\nlet wasLeader: boolean = false;\n'})}),"\n",(0,s.jsx)(n.p,{children:"Check if a leader already exists, otherwise request leadership.\nWe also need to handle the case in which the Leader tab gets closed and therefore we need to transfer the leadership to another tab."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'elector.hasLeader().then(async (hasLeader) => {\n  if (!hasLeader) {\n    await elector.awaitLeadership();\n    wasLeader = elector.isLeader;\n  }\n});\n\n// NOTE: If you are using a JS framework, do not call window.onbeforeunload directly.\n// Refer to your framework\'s guidelines for handling this scenario.\nwindow.onbeforeunload = async () => {\n  if (wasLeader) {\n    await elector.die();\n    channel.postMessage("LEADER_DEAD");\n  }\n};\n\nchannel.onmessage = async (message: any) => {\n  if (message === "LEADER_DEAD") {\n    await elector.awaitLeadership();\n  }\n};\n'})}),"\n",(0,s.jsx)(n.h3,{id:"step-3-update-the-handler",children:"Step 3: Update the Handler"}),"\n",(0,s.jsxs)(n.p,{children:["Now, inside the handler, check whether the current tab has the leadership. If not, do not send a ",(0,s.jsx)(n.code,{children:"sign_payload"})," request."]}),"\n",(0,s.jsxs)(o.A,{groupId:"beaconOrTaquitoSAAE4",defaultValue:"beacon",values:[{label:"Beacon",value:"beacon"},{label:"Taquito",value:"taquito"}],children:[(0,s.jsx)(c.A,{value:"beacon",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'dAppClient.subscribeToEvent(BeaconEvent.ACTIVE_ACCOUNT_SET, async (account) => {\n  console.log(\n    `${BeaconEvent.ACTIVE_ACCOUNT_SET} triggered: `,\n    account?.address,\n  );\n\n  if (!account || !elector.isLeader) {\n    return;\n  }\n\n  try {\n    await dAppClient.requestSignPayload({\n      payload:\n        "05010000004254657a6f73205369676e6564204d6573736167653a207465737455726c20323032332d30322d30385431303a33363a31382e3435345a2048656c6c6f20576f726c64",\n    });\n  } catch (err: any) {\n    // The request was rejected\n    // handle disconnection\n  }\n});\n'})})}),(0,s.jsx)(c.A,{value:"taquito",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'wallet.client.subscribeToEvent(\n  BeaconEvent.ACTIVE_ACCOUNT_SET,\n  async (account) => {\n    console.log(\n      `${BeaconEvent.ACTIVE_ACCOUNT_SET} triggered: `,\n      account?.address,\n    );\n\n    if (!account || !elector.isLeader) {\n      return;\n    }\n\n    try {\n      await wallet.client.requestSignPayload({\n        payload:\n          "05010000004254657a6f73205369676e6564204d6573736167653a207465737455726c20323032332d30322d30385431303a33363a31382e3435345a2048656c6c6f20576f726c64",\n      });\n    } catch (err: any) {\n      // The request was rejected\n      // handle disconnection\n    }\n  },\n);\n'})})})]}),"\n",(0,s.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,s.jsx)(n.p,{children:"The end result should look like this:"}),"\n",(0,s.jsxs)(o.A,{groupId:"beaconOrTaquitoSAAE5",defaultValue:"beacon",values:[{label:"Beacon",value:"beacon"},{label:"Taquito",value:"taquito"}],children:[(0,s.jsx)(c.A,{value:"beacon",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { DAppClient, BeaconEvent } from "@airgap/beacon-dapp";\nimport { NetworkType } from "@airgap/beacon-types";\nimport { BroadcastChannel, createLeaderElection } from "broadcast-channel";\n\nconst channel = new BroadcastChannel("beacon-test");\nconst elector = createLeaderElection(channel);\nlet wasLeader: boolean = false;\n\nelector.hasLeader().then(async (hasLeader) => {\n  if (!hasLeader) {\n    await elector.awaitLeadership();\n    wasLeader = elector.isLeader;\n  }\n});\n\nwindow.onbeforeunload = async () => {\n  if (wasLeader) {\n    await elector.die();\n    channel.postMessage("LEADER_DEAD");\n  }\n};\n\nchannel.onmessage = async (message: any) => {\n  if (message === "LEADER_DEAD") {\n    await elector.awaitLeadership();\n  }\n};\n\nconst dAppClient = new DAppClient({\n  name: "Beacon Docs",\n  network: {\n    type: NetworkType.GHOSTNET,\n  },\n});\n\ndAppClient.subscribeToEvent(BeaconEvent.ACTIVE_ACCOUNT_SET, async (account) => {\n  console.log(\n    `${BeaconEvent.ACTIVE_ACCOUNT_SET} triggered: `,\n    account?.address,\n  );\n\n  if (!account || !elector.isLeader) {\n    return;\n  }\n\n  try {\n    await dAppClient.requestSignPayload({\n      payload:\n        "05010000004254657a6f73205369676e6564204d6573736167653a207465737455726c20323032332d30322d30385431303a33363a31382e3435345a2048656c6f20576f726c64",\n    });\n  } catch (err: any) {\n    // The request was rejected\n    // handle disconnection\n  }\n});\n\ndAppClient.requestPermissions();\n'})})}),(0,s.jsx)(c.A,{value:"taquito",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { TezosToolkit } from "@taquito/taquito";\nimport { BeaconWallet } from "@taquito/beacon-wallet";\nimport { BeaconEvent } from "@airgap/beacon-dapp";\nimport { BroadcastChannel, createLeaderElection } from "broadcast-channel";\n\nconst channel = new BroadcastChannel("beacon-test");\nconst elector = createLeaderElection(channel);\nlet wasLeader: boolean = false;\n\nelector.hasLeader().then(async (hasLeader) => {\n  if (!hasLeader) {\n    await elector.awaitLeadership();\n    wasLeader = elector.isLeader;\n  }\n});\n\nwindow.onbeforeunload = async () => {\n  if (wasLeader) {\n    await elector.die();\n    channel.postMessage("LEADER_DEAD");\n  }\n};\n\nchannel.onmessage = async (message: any) => {\n  if (message === "LEADER_DEAD") {\n    await elector.awaitLeadership();\n  }\n};\n\nconst Tezos = new TezosToolkit("https://mainnet.api.tez.ie");\nconst wallet = new BeaconWallet({ name: "Beacon Docs" });\n\nTezos.setWalletProvider(wallet);\n\nwallet.client.subscribeToEvent(\n  BeaconEvent.ACTIVE_ACCOUNT_SET,\n  async (account) => {\n    console.log(\n      `${BeaconEvent.ACTIVE_ACCOUNT_SET} triggered: `,\n      account?.address,\n    );\n\n    if (!account || !elector.isLeader) {\n      return;\n    }\n\n    try {\n      await wallet.client.requestSignPayload({\n        payload:\n          "05010000004254657a6f73205369676e6564204d6573736167653a207465737455726c20323032332d30322d30385431303a33363a31382e3435345a2048656c6f20576f726c64",\n      });\n    } catch (err: any) {\n      // The request was rejected\n      // handle disconnection\n    }\n  },\n);\n\nwallet.client.requestPermissions();\n'})})})]}),"\n",(0,s.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/pubkey/broadcast-channel?tab=readme-ov-file#readme",children:"BroadcastChannel"}),": Documentation and usage examples for the ",(0,s.jsx)(n.code,{children:"broadcast-channel"})," library."]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);